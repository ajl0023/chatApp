(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{97:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(0),i=n.n(c),a=n(53),o=n.n(a),s=n(35),u=n(4),l=n(15),d=n(2),j=n(56),f=n(54),m=n.n(f);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}var g=c.createElement("path",{d:"M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 C22.8132856,11.0605983 22.3423792,10.4322088 21.714504,10.118014 L4.13399899,1.16346272 C3.34915502,0.9 2.40734225,1.00636533 1.77946707,1.4776575 C0.994623095,2.10604706 0.8376543,3.0486314 1.15159189,3.99121575 L3.03521743,10.4322088 C3.03521743,10.5893061 3.34915502,10.7464035 3.50612381,10.7464035 L16.6915026,11.5318905 C16.6915026,11.5318905 17.1624089,11.5318905 17.1624089,12.0031827 C17.1624089,12.4744748 16.6915026,12.4744748 16.6915026,12.4744748 Z",fillRule:"evenodd",stroke:"none"});function O(e,t){var n=e.title,r=e.titleId,i=h(e,["title","titleId"]);return c.createElement("svg",b({className:"crt8y2ji",height:"20px",width:"20px",viewBox:"0 0 24 24",ref:t,"aria-labelledby":r},i),n?c.createElement("title",{id:r},n):null,g)}var p=c.forwardRef(O),v=(n.p,i.a.forwardRef((function(e,t){var n,i=e.handleSubmit,a=e.value,o=Object(c.useRef)();o.current&&(n=o.current.innerHTML),Object(c.useEffect)((function(){a!==o.current.innerHTML&&(o.current.innerHTML=a)}),[n]);return Object(r.jsxs)("div",{ref:t,className:"input-container",children:[Object(r.jsx)("div",{ref:o,contentEditable:!0,"data-contents":"true",role:"textbox","data-text":"true",name:"text",dangerouslySetInnerHTML:{__html:a},onKeyDown:function(e){return i(e,o)},className:"input-box",onInput:function(){},type:"text"}),Object(r.jsx)(p,{className:"submit-button",onClick:function(e){return i(e,o)}})]})}))),x=function(e){var t=e.msg,n=e.currentUser,i=e.getPosition,a=e.handleMouseOut,o=Object(c.useRef)(),s=document.getElementById("bottom");Object(c.useEffect)((function(){s.scrollIntoView({block:"end"})}),[]);return o.current&&o.current.getBoundingClientRect(),Object(r.jsxs)("div",{className:"messages",children:[Object(r.jsxs)("div",{id:t.sentAt,className:function(e){return e.id===n?"currentUser-text-container":"admin"===e.user?"admin-text-container":"incoming-text-container"}(t),children:[Object(r.jsxs)("div",{ref:o,className:"message-profile-container",children:["admin"!==t.user&&t.id!==n?Object(r.jsx)("span",{onMouseEnter:function(e){i(e,t,t.user,n===t.id)},onMouseLeave:function(){a()},style:{backgroundImage:t.profile&&t.profile.grad},className:"profile-picture-container"}):null,Object(r.jsx)("p",{onMouseEnter:function(e){i(e,t,null,n===t.id)},onMouseLeave:function(){a()},className:function(e){return e.id===n?"currentUser-message":"admin"===e.user?"admin-message":"incoming-message"}(t),dangerouslySetInnerHTML:{__html:t.text}})]})," "]})," "]})},y=n(19),N=n.n(y),C=N()(""),E=i.a.createContext(),w=function(e){var t=Object(c.useRef)();return Object(r.jsx)("div",{ref:t,children:Object(r.jsx)("div",{onMouseOver:function(t){e.getPosition(t,null,e.users.name)},onMouseOut:function(){e.handleMouseOut()},className:"userbar-image-container",src:e.users.image,alt:"",style:{backgroundImage:e.users.grad}})})},M=function(e){var t=e.location,n=Object(c.useState)([]),i=Object(u.a)(n,2),a=i[0],o=i[1],s=Object(c.useState)(""),l=Object(u.a)(s,2),f=l[0],b=l[1],h=Object(c.useState)([]),g=Object(u.a)(h,2)[1],O=Object(c.useState)([]),p=Object(u.a)(O,2),y=p[0],N=p[1],M=m.a.parse(t.search),S=M.name,I=M.room,R=Object(c.useState)({}),k=Object(u.a)(R,2)[1],B=Object(c.useState)(!1),L=Object(u.a)(B,2)[1],P=Object(c.useState)({}),U=Object(u.a)(P,2)[1],A=Object(c.useRef)(null),H=Object(d.e)(),T=Object(c.useRef)();Object(c.useEffect)((function(){return C.emit("connectCheck",I,(function(e){e||H.push("/")})),window.addEventListener("beforeunload",(function(e){e.preventDefault(),C.emit("disconnectUser",S,I)})),function(){for(var e=document.getElementById("tooltip-container"),t=document.getElementById("root");e;)t.removeChild(e),e=document.getElementById("tooltip-container");C.emit("disconnectUser",S,I)}}),[]),Object(c.useEffect)((function(){C.on("getUsers",(function(e){N(e)})),C.emit("getUsers",I),C.on("getMessages",(function(e){g((function(t){var n=JSON.parse(JSON.stringify(t)),r={},c=n.length-1,i=n[c]&&Object.getOwnPropertyNames(n[c])[0];if("admin"!==i&&t.length>1&&e.sentAt-n[c][i][n[c][i].length-1].sentAt>=3.6*Math.pow(10,6)){var a=new Date(e.sentAt).getHours(),s=new Date(e.sentAt).getMinutes(),u="".concat(0===a?12:a>12?a-12:a,":").concat(s<10?"0"+s:s," ").concat(a>12?"PM":"AM");n.push({admin:[{user:"admin",text:u}]}),i="admin"}c>=0&&i===e.user?n[c][e.user]=[].concat(Object(j.a)(n[c][e.user]),[e]):(r[e.user]=[e],n.push(r)),n.forEach((function(e){var t=Object.getOwnPropertyNames(e)[0];e[t].forEach((function(e){delete e.profile}));var n=e[t].length-1;e[t][n].profile=e[t][n].gradient}));var l=n.reduce((function(e,t){for(var n=Object.getOwnPropertyNames(t)[0],r=0;r<t[n].length;r++)e.push(t[n][r]);return e}),[]);return o((function(){return l})),n}))})),C.emit("initial",I)}),[t.search]);var D=function(){},J=function(){U((function(){return!1}));for(var e=document.getElementById("tooltip-container");e.firstChild;)e.removeChild(e.firstChild)},_=function(e,t,n,r){if(n||t&&"admin"!==t.user){U((function(){return{state:!0,message:e}}));var c=document.createElement("p"),i=document.getElementById("tooltip-container");if(t&&t.sentAt&&!n){c.className="timestamp-hover-currentUser";var a=new Date(t.sentAt).getHours(),o=new Date(t.sentAt).getMinutes();c.innerHTML="".concat(0===a?12:a>12?a-12:a,":").concat(o<10?"0"+o:o," ").concat(a>12?"PM":"AM")}else n&&(c.className="hover-user",c.innerHTML=n);i.style.position="absolute",i.style.inset="0px auto auto 0px",i.appendChild(c),i.style.display="block";var s,u=i.getBoundingClientRect(),l=(s=e.target.getBoundingClientRect()).y+s.height/2-u.height/2;i.style.transform="translate(".concat("".concat(r?s.right:s.left-i.getBoundingClientRect().width,"px"),",","".concat(l,"px"),")")}},z=function(){var e=document.getElementById("tooltip-container");U((function(t){if(t.state){var n=t.message.target.getBoundingClientRect(),r=e.getBoundingClientRect(),c=n.y+n.height/2-r.height/2;e.style.transform="translate(".concat("".concat(n.right,"px"),",","".concat(c,"px"),")"),e.style.display="block"}return t}))};Object(c.useEffect)((function(){window.addEventListener("resize",z);var e=document.createElement("div");return e.setAttribute("id","tooltip-container"),document.getElementById("root").appendChild(e),function(){window.removeEventListener("resize",z)}}),[]);var F=function(e,t){L(!0),k(e),U(t)},K=function(e){L(e)},V=Object(c.useRef)(null);return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)("div",{className:"chat-wrapper",children:Object(r.jsx)("div",{className:"scrollRef-wrapper",children:Object(r.jsxs)("div",{className:"chat-message-container",children:[Object(r.jsx)("div",{className:"userbar-container",children:y.map((function(e){return Object(r.jsx)(w,{handleMouseOut:J,getPosition:_,users:e})}))}),Object(r.jsxs)("div",{className:"container-2",children:[Object(r.jsx)("p",{className:"chat-header",children:I}),Object(r.jsx)("div",{onScroll:function(){var e=document.getElementById("tooltip-container");U((function(t){if(t.state){var n=t.message.target.getBoundingClientRect(),r=e.getBoundingClientRect(),c=n.y+n.height/2-r.height/2;e.style.transform="translate(".concat("".concat(n.right,"px"),",","".concat(c,"px"),")"),e.style.display="block"}return t}))},ref:T,id:"msg-box",className:"chat-message-box",children:Object(r.jsx)(E.Consumer,{children:function(e){var n=e.currentUser;return Object(r.jsxs)("div",{ref:V,className:"chat-box-container",children:[a.map((function(e){return Object(r.jsx)(x,{getRef:D,getPosition:_,handleMouseOut:J,checkHoverState:K,timeStampFunc:F,currentUser:n,location:t,msg:e},e.sentAt)})),Object(r.jsx)("div",{id:"bottom",className:"bottom-of-div",ref:A})]})}})}),Object(r.jsx)("div",{}),Object(r.jsx)(v,{value:f,handleSubmit:function(e,t){if("Enter"===e.key||"click"===e.type){var n=t.current.innerText.trim();if(!(n.length>0))return;C.emit("getMessages",S,I,n)}},handleChange:function(e){b(e.target.innerText)}})]})]})})})})};function S(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),i=n[0],a=n[1],o=Object(c.useState)(""),s=Object(u.a)(o,2),l=s[0],j=s[1],f=Object(c.useState)(!1),m=Object(u.a)(f,2),b=m[0],h=m[1],g=Object(d.e)();Object(c.useEffect)((function(){(C=N()("")).on("connect",(function(){})),C.id||N.a.connect(),C.on("join",(function(e){e.error&&h(e)}))}),[]);var O=function(t){"Enter"!==t.key&&"click"!==t.type||C.emit("join",i,l,C.id,(function(t){t.error||(e.getCurrentUser(C.id),g.push("/chat?name=".concat(i,"&room=").concat(l)))}))};return Object(r.jsx)("div",{className:"join-wrapper",children:Object(r.jsxs)("div",{onClick:function(){h(!1)},className:"join-container",children:[Object(r.jsx)("h1",{className:"join-header",children:"Join"}),Object(r.jsxs)("div",{className:"join-input-container",children:[Object(r.jsx)("div",{children:Object(r.jsx)("input",{className:"input-field",placeholder:"Name",type:"text",onChange:function(e){a(e.target.value)}})}),Object(r.jsxs)("div",{className:"input-field-room-container",children:[Object(r.jsx)("input",{className:"input-field-room",onKeyDown:function(e){return O(e)},placeholder:"Room",type:"text",onChange:function(e){return j(e.target.value)}}),Object(r.jsx)("div",{className:b?"error-container":"inactive",children:Object(r.jsx)("p",{className:"error-message",children:b.error})})]})]}),Object(r.jsx)("button",{className:"join-signin-but",onClick:function(e){return i&&l?O(e):e.preventDefault()},type:"submit",children:"Sign In"})]})})}n(97);var I=function(){var e=Object(c.useState)({}),t=Object(u.a)(e,2),n=t[0],i=t[1],a=function(e){i(e)};return Object(r.jsxs)(l.a,{children:[" ",Object(r.jsxs)(E.Provider,{value:{currentUser:n},children:[Object(r.jsx)(d.a,{path:"/",exact:!0,render:function(e){return Object(r.jsx)(S,Object(s.a)({getCurrentUser:a},e))}}),Object(r.jsx)(d.a,{path:"/chat",exact:!0,render:function(e){return Object(r.jsx)(M,Object(s.a)({},e))}})]})]})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(l.a,{children:Object(r.jsx)(I,{})})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.e3eef55a.chunk.js.map